<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DynamicClassFactory.CreateType Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CreateType method" /><meta name="System.Keywords" content="DynamicClassFactory.CreateType method" /><meta name="Microsoft.Help.F1" content="System.Linq.Dynamic.Core.DynamicClassFactory.CreateType" /><meta name="Microsoft.Help.Id" content="M:System.Linq.Dynamic.Core.DynamicClassFactory.CreateType(System.Collections.Generic.IList{System.Linq.Dynamic.Core.DynamicProperty},System.Boolean)" /><meta name="Description" content="The CreateType method creates a new data class with a given set of public properties and returns the System.Type object for the newly created class. If a data class with an identical sequence of properties has already been created, the System." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="System.Linq.Dynamic.Core" /><meta name="file" content="a25424f0-7800-a591-fd75-1937b7d2df64" /><meta name="guid" content="a25424f0-7800-a591-fd75-1937b7d2df64" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">System.Linq.Dynamic.Core, EntityFramework.DynamicLinq and Microsoft.EntityFrameworkCore.DynamicLinq<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="144078bd-d1ad-bece-4daa-7fdd3a7ed7dc.htm" title="System.Linq.Dynamic.Core, EntityFramework.DynamicLinq and Microsoft.EntityFrameworkCore.DynamicLinq" tocid="roottoc">System.Linq.Dynamic.Core, EntityFramework.DynamicLinq and Microsoft.EntityFrameworkCore.DynamicLinq</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="de47654c-7ae4-9302-3061-ea6307706cb8.htm" title="System.Linq.Dynamic.Core" tocid="de47654c-7ae4-9302-3061-ea6307706cb8">System.Linq.Dynamic.Core</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="8ae68a72-152c-5428-1973-60844a869bae.htm" title="DynamicClassFactory Class" tocid="8ae68a72-152c-5428-1973-60844a869bae">DynamicClassFactory Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="844c188b-1abe-ae61-9fed-3bcfa67f1147.htm" title="DynamicClassFactory Methods" tocid="844c188b-1abe-ae61-9fed-3bcfa67f1147">DynamicClassFactory Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="a25424f0-7800-a591-fd75-1937b7d2df64.htm" title="CreateType Method " tocid="a25424f0-7800-a591-fd75-1937b7d2df64">CreateType Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>DynamicClassFactory<span id="LST21A046C0_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST21A046C0_0?cpp=::|nu=.");</script>CreateType Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The CreateType method creates a new data class with a given set of public properties and returns the System.Type object for the newly created class. If a data class with an identical sequence of properties has already been created, the System.Type object for this class is returned.        
            Data classes implement private instance variables and read/write property accessors for the specified properties.Data classes also override the Equals and GetHashCode members to implement by-value equality.
            Data classes are created in an in-memory assembly in the current application domain. All data classes inherit from <a href="e342c1b4-0ab2-9ff9-bbcb-78004b2d924d.htm">DynamicClass</a> and are given automatically generated names that should be considered private (the names will be unique within the application domain but not across multiple invocations of the application). Note that once created, a data class stays in memory for the lifetime of the current application domain. There is currently no way to unload a dynamically created data class.
            The dynamic expression parser uses the CreateClass methods to generate classes from data object initializers. This feature in turn is often used with the dynamic Select method to create projections.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="de47654c-7ae4-9302-3061-ea6307706cb8.htm">System.Linq.Dynamic.Core</a><br />
    <strong>Assembly:</strong>
   System.Linq.Dynamic.Core (in System.Linq.Dynamic.Core.dll) Version: 1.0.8.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Type</span> <span class="identifier">CreateType</span>(
	<span class="identifier">IList</span>&lt;<span class="identifier">DynamicProperty</span>&gt; <span class="parameter">properties</span>,
	<span class="identifier">bool</span> <span class="parameter">createParameterCtor</span> = <span class="keyword">true</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">properties</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5y536ey6" target="_blank">System.Collections.Generic<span id="LST21A046C0_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST21A046C0_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IList</a><span id="LST21A046C0_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST21A046C0_2?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="e7f88c42-6076-1782-76c7-7f00bb2ba6b4.htm">DynamicProperty</a><span id="LST21A046C0_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST21A046C0_3?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />The DynamicProperties</dd><dt><span class="parameter">createParameterCtor</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST21A046C0_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST21A046C0_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />Create a constructor with parameters. Default set to true. Note that for Linq-to-Database objects, this needs to be set to false.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/42892f65" target="_blank">Type</a><br />Type</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">DynamicProperty[] props = <span class="highlight-keyword">new</span> DynamicProperty[] { <span class="highlight-keyword">new</span> DynamicProperty(<span class="highlight-literal">"Name"</span>, <span class="highlight-keyword">typeof</span>(<span class="highlight-keyword">string</span>)), <span class="highlight-keyword">new</span> DynamicProperty(<span class="highlight-literal">"Birthday"</span>, <span class="highlight-keyword">typeof</span>(DateTime)) };
Type type = DynamicClassFactory.CreateType(props);
DynamicClass dynamicClass = Activator.CreateInstance(type) <span class="highlight-keyword">as</span> DynamicClass;
dynamicClass.SetDynamicProperty(<span class="highlight-literal">"Name"</span>, <span class="highlight-literal">"Albert"</span>);
dynamicClass.SetDynamicProperty(<span class="highlight-literal">"Birthday"</span>, <span class="highlight-keyword">new</span> DateTime(<span class="highlight-number">1879</span>, <span class="highlight-number">3</span>, <span class="highlight-number">14</span>));
Console.WriteLine(dynamicClass);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="8ae68a72-152c-5428-1973-60844a869bae.htm">DynamicClassFactory Class</a></div><div class="seeAlsoStyle"><a href="de47654c-7ae4-9302-3061-ea6307706cb8.htm">System.Linq.Dynamic.Core Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>